## create virtual environment on ubuntu
 
1. `sudo apt install python3-venv`
2. `python3 -m venv [venv-name]`
3. `source venv/bin/activate`
4. which python - to check if the venv is activated 
[output]: /home/kennedy-anyidoho/devmode/python/python-pastebin/venv/bin/python
5. add a .gitignore file in the venv folder and put * in it for git to ignore everything in that dir
6. install fastAPI - `pip install "fastapi[standard]"`
7. create a main.py file in the roor of your directory and run `python main.py`
8 you can deactivate the venv after you are done with your work - `deactivate`



```mdx
# Building a Pastebin API with Flask and PostgreSQL (Neon)

This guide explains how to create a Pastebin API using Flask and PostgreSQL hosted on Neon. The API will allow users to create text pastes with unique URLs and retrieve them later. We'll cover the setup, configuration, and testing process without diving into the full code.

## Prerequisites

- Python 3.12+ installed
- A [Neon](https://neon.tech) account for PostgreSQL hosting
- Basic understanding of Flask, REST APIs, and SQL

## Project Setup

### Step 1: Project Structure

Set up your project with the following structure:

```
pastebin_api/
├── app.py              # Main Flask application file
├── database.py         # Database connection and query logic
├── .flaskenv          # Environment variables for Flask
├── requirements.txt   # Python dependencies
```

- `app.py`: Contains Flask routes for creating and retrieving pastes.
- `database.py`: Manages database connections and queries.
- `.flaskenv`: Stores environment variables like the database URL.
- `requirements.txt`: Lists required Python packages.

### Step 2: Install Dependencies

In your `requirements.txt`, include:

- `flask`: For building the web API
- `psycopg2-binary`: For PostgreSQL connectivity (precompiled to avoid build issues)
- `nanoid`: For generating unique paste IDs
- `python-dotenv`: For loading environment variables from `.flaskenv`

Install them in a virtual environment:

1. Create and activate a virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```
2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

### Step 3: Set Up Neon PostgreSQL

1. Sign up for a Neon account and create a new PostgreSQL project.
2. From the Neon dashboard, copy the connection string (e.g., `postgresql://user:password@host.neon.tech/dbname`).
3. Create a table named `pastes` with columns:
   - `paste_id` (e.g., VARCHAR(6), primary key): Stores the unique paste ID
   - `content` (e.g., TEXT): Stores the paste text
   - `created_at` (e.g., TIMESTAMP): Records when the paste was created

## Configuration

### Step 4: Environment Variables

Create a `.flaskenv` file to manage Flask and database settings. Here's an example:

```plaintext
# Example .flaskenv
FLASK_APP=app.py
FLASK_ENV=development
DATABASE_URL=postgresql://pastebin_user:secure_password123@ep-quiet-hill-123456.us-east-2.aws.neon.tech/pastebin_db?sslmode=require
```

- `FLASK_APP`: Specifies the main application file.
- `FLASK_ENV`: Sets the environment (use `production` for deployment).
- `DATABASE_URL`: Your Neon connection string (replace with your actual credentials).
- `sslmode=require`: Ensures a secure connection to Neon.

## API Design

### Step 5: Database Logic

In `database.py`, you'll need:
- A connection pool to manage database connections efficiently.
- A function to create a paste (generate a unique ID, insert into the database, return the ID).
- A function to retrieve a paste by ID (query the database and return the content).

Use the Neon connection string from `.flaskenv` to connect to the database.

### Step 6: Flask Routes

In `app.py`, define two endpoints:
- **POST `/api/paste`**: Accepts JSON with a `content` field, saves it with a unique ID, and returns a URL.
- **GET `/api/paste/<paste_id>`**: Retrieves the paste content by its ID or returns a 404 if not found.

The flow:
1. User sends paste content → API generates a unique ID → Stores in database → Returns URL.
2. User visits URL → API queries database → Returns content or error.

## Running the API

### Step 7: Launch the App

With your virtual environment activated, run:

```bash
flask run
```

The API will start at `http://localhost:5000`. The `FLASK_ENV=development` setting enables debug mode for easier troubleshooting.

## Testing the API

### Create a Paste
Send a POST request:

```bash
curl -X POST -H "Content-Type: application/json" -d '{"content":"Hello, world!"}' http://localhost:5000/api/paste
```

Expected response:
```json
{
  "url": "http://localhost:5000/api/paste/x7h2Kp"
}
```

### Retrieve a Paste
Use the URL from the response:

```bash
curl http://localhost:5000/api/paste/x7h2Kp
```

Expected response:
```json
{
  "content": "Hello, world!"
}
```

## Deployment Tips

- **Update Base URL**: Replace `localhost:5000` with your production domain in the API responses.
- **Use a WSGI Server**: For production, install `gunicorn` and run:
  ```bash
  gunicorn --bind 0.0.0.0:8000 app:app
  ```
- **Secure Environment**: Store `DATABASE_URL` in a secure location (e.g., server environment variables) instead of `.flaskenv` for production.

## Troubleshooting

- **Database Connection**: Ensure `DATABASE_URL` is correct and Neon’s firewall allows your IP.
- **Dependency Issues**: Use `psycopg2-binary` to avoid local PostgreSQL requirements.
- **API Errors**: Check Flask’s debug output (`FLASK_ENV=development`) for clues.

This setup provides a solid foundation for a Pastebin API. You can extend it with features like paste expiration, rate limiting, or a web frontend.
```

---

### Notes
- The document avoids specific code implementations, focusing on the process and structure.
- The example `.flaskenv` uses placeholder values for the Neon connection string—replace them with your actual credentials from the Neon dashboard.
- This MDX file is ready for use in a documentation site or can be adapted further based on your needs.

Let me know if you'd like to adjust anything, like adding more sections or refining the tone!